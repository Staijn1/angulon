<div class='vh-100 d-flex flex-column bg-black' id='wrapper'>
  <div class="toolbar-container">
    <div class="toolbar">
      <!--      Button group-->
      <div class="btn-group">
        <button type="button" class="btn btn-primary" (click)="openSettingsWindow()">
          <fa-icon [icon]="settingsIcon" (click)="openSettingsWindow()"></fa-icon>
        </button>
        <button class='btn btn-primary' (click)='fullscreen()'>
          <fa-icon [icon]='fullscreenIcon'></fa-icon>
        </button>
        <button class='btn btn-primary' (click)='updateLedstrip()'>
          <fa-icon [icon]='modeIcon'></fa-icon>
        </button>
      </div>
    </div>
  </div>
  <div class='h-75'>
    <app-shared-visualizer (ready)="init()" (registeredGradients)="readSettings()" [options]='visualizerOptions'
                           [gradients]='gradients'></app-shared-visualizer>
  </div>
</div>
<app-offcanvas>
  <div header class="p-1"><h3>Settings</h3></div>
  <div body class="p-3">
    <!--    Create tabs-->
    <ul ngbNav #nav="ngbNav" [(activeId)]="activeTab" class="nav-tabs">
      <li [ngbNavItem]="0">
        <a ngbNavLink>
          <fa-icon [icon]="listIcon"></fa-icon>
        </a>
        <ng-template ngbNavContent>
          <div>
            <!--    Select box for the gradients-->
            <div class="form-group">
              <label for="gradients">Gradient</label>
              <select class="form-control" id="gradients" (change)="applySettings()"
                      [(ngModel)]="visualizerOptions.gradient">
                <option *ngFor="let gradient of gradients" [ngValue]="gradient.name">{{gradient.name}}</option>
              </select>
            </div>
            <!--    Select box for the display modes-->
            <div class="form-group">
              <label for="modes">Display Mode</label>
              <select class="form-control" id="modes" (change)="applySettings()" [(ngModel)]="visualizerOptions.mode">
                <option *ngFor="let mode of modes" [ngValue]="mode.value">{{mode.text}}</option>
              </select>
            </div>
            <!--    Selectbox for mirror. Accepted values are -1 for mirror left, 0 for no mirror and 1 for mirror right-->
            <div class="form-group">
              <label for="mirror">Mirror</label>
              <select class="form-control" id="mirror" (change)="applySettings()"
                      [(ngModel)]="visualizerOptions.mirror">
                <option [ngValue]="-1">Left</option>
                <option [ngValue]="0">None</option>
                <option [ngValue]="1">Right</option>
              </select>
            </div>
            <!--    Selectbox for FFT bin size-->
            <div class="form-group">
              <label for="fftBinSize">FFT Bin Size</label>
              <select class="form-control" id="fftBinSize" (change)="applySettings()"
                      [(ngModel)]="visualizerOptions.fftSize">
                <option [ngValue]="512">512</option>
                <option [ngValue]="1024">1024</option>
                <option [ngValue]="2048">2048</option>
                <option [ngValue]="4096">4096</option>
                <option [ngValue]="8192">8192</option>
                <option [ngValue]="16384">16384</option>
                <option [ngValue]="32768">32768</option>
              </select>
            </div>
          </div>
        </ng-template>
      </li>
      <li [ngbNavItem]="1">
        <a ngbNavLink>
          <fa-icon [icon]="checkboxIcon"></fa-icon>
        </a>
        <ng-template ngbNavContent>
          <div>
            <!--    Checkbox for alpha bars-->
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="alphaBars" (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.alphaBars">
              <label class="form-check-label" for="alphaBars">Alpha Bars</label>
            </div>
            <!--Checkbox for led bars -->
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="ledBars" (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.ledBars">
              <label class="form-check-label" for="ledBars">Led Bars</label>
            </div>
            <!-- Checkbox for luminance bars -->
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="luminanceBars" (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.lumiBars">
              <label class="form-check-label" for="luminanceBars">Luminance Bars</label>
            </div>
            <!--Checkbox for showing peaks-->
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="showPeaks" (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.showPeaks">
              <label class="form-check-label" for="showPeaks">Show Peaks</label>
            </div>
            <!--    Checkbox for showing outline bars. Only works when mode is on of the octave bands-->
            <div class="form-check">
              <input type="checkbox" class="form-check-input" id="showOutline"
                     title="Only works when mode is one of the octave bands"
                     (change)="applySettings()"
                     [disabled]="!isOctaveBandMode"
                     [(ngModel)]="visualizerOptions.outlineBars">
              <label class="form-check-label" for="showOutline">Show Outline</label>
            </div>
            <!--    Checkbox for show scale on X axis-->
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="showScaleX"
                     (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.showScaleX">
              <label class="form-check-label" for="showScaleX">
                Show scale on X axis
              </label>
            </div>
            <!--    Checkbox for show scale on Y axis-->
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="showScaleY"
                     (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.showScaleY">
              <label class="form-check-label" for="showScaleY">
                Show scale on Y axis
              </label>
            </div>
            <!--    Checkbox for radial-->
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="radial"
                     (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.radial">
              <label class="form-check-label" for="radial">
                Radial
              </label>
            </div>
            <!--    Checkbox for stereo mode-->
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="stereo"
                     (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.stereo">
              <label class="form-check-label" for="stereo">
                Stereo
              </label>
            </div>
            <!--    When stereo is enabled, show a checkbox to split gradient-->
            <div class="form-check">
              <input class="form-check-input" type="checkbox" id="splitGradient"
                     [disabled]="!visualizerOptions.stereo"
                     (change)="applySettings()"
                     [(ngModel)]="visualizerOptions.splitGradient">
              <label class="form-check-label" for="splitGradient">
                Split Gradient
              </label>
            </div>
          </div>
        </ng-template>
      </li>
      <li [ngbNavItem]="2">
        <a ngbNavLink>
          <fa-icon [icon]="sliderIcon"></fa-icon>
        </a>
        <ng-template ngbNavContent>
          <div>
            <!--      Simple slider for smoothing-->
            <div>
              Smoothing
              <ngx-slider *ngIf="visualizerOptions.smoothing" (valueChange)="applySettings()"
                          [(value)]="visualizerOptions.smoothing"
                          [options]="smoothingSliderOptions"></ngx-slider>
            </div>
            <!--Simple slider for rotation speed, only visible when radial is true-->
            <div>
              Rotation Speed
              <ngx-slider *ngIf="visualizerOptions.spinSpeed !== undefined" (valueChange)="applySettings()"
                          [(value)]="visualizerOptions.spinSpeed"
                          [options]="spinSpeedSliderOptions"></ngx-slider>
            </div>
            <!--      Range slider for min and max frequency-->
            <div>
              Min Frequency
              <ngx-slider *ngIf="visualizerOptions.minFreq !== undefined && visualizerOptions.maxFreq !== undefined"
                          (valueChange)="applySettings()"
                          [(value)]="visualizerOptions.minFreq"
                          [(highValue)]="visualizerOptions.maxFreq"
                          [options]="frequencySliderOptions"></ngx-slider>
            </div>
            <!--      Simple slider for line width-->
            <div>
              Line Width
              <ngx-slider *ngIf="visualizerOptions.lineWidth !== undefined" (valueChange)="applySettings()"
                          [(value)]="visualizerOptions.lineWidth"
                          [options]="lineWidthSliderOptions"></ngx-slider>
            </div>
            <!--      Simple slider for fill alpha-->
            <div>
              Fill Alpha
              <ngx-slider *ngIf="visualizerOptions.fillAlpha !== undefined" (valueChange)="applySettings()"
                          [(value)]="visualizerOptions.fillAlpha"
                          [options]="fillAlphaSliderOptions"></ngx-slider>
            </div>
          </div>
        </ng-template>
      </li>
    </ul>
    <div [ngbNavOutlet]="nav" class="mt-2"></div>

  </div>
</app-offcanvas>
